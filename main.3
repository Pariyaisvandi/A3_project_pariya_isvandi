#project 3 
#pariya_isvandi

from sklearn.datasets import load_breast_cancer
data=load_breast_cancer()
x=data.data
y=data.target

data.feature_names

data.target_names

#==============================================================

#----------EXAMPLE-------
from sklearn.model_selection import KFold
kf= KFold(n_splits=5,shuffle=True,random_state=42)

#-----MODEL SELECTION
from sklearn.neighbors import KNeighborsClassifier
model=KNeighborsClassifier()
my_params= { 'n_neighbors':[3,5,7,8,9],
            'metric':['minkowski'  , 'euclidean' , 'manhattan'],
           'weights':['uniform','distance']}

from sklearn.model_selection import GridSearchCV

gs=GridSearchCV(model,my_params,cv=kf,scoring='accuracy')
gs.fit(x,y)

print(gs.best_score_)
#0.9419810588417947

print(gs.best_params_)
#{'metric': 'manhattan', 'n_neighbors': 5, 'weights': 'uniform'}

#===============================================================
#SVC
from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test=train_test_split(x,y,test_size=0.25, shuffle=True, random_state=42)

from sklearn.svm import SVC 

model=SVC()  

model=SVC(kernel='poly',degree=2) 

model.fit(x_train,y_train)

y_train_pred=model.predict(x_train)

from sklearn.metrics import accuracy_score
train_score=accuracy_score(y_train, y_train_pred)
print('Train score accuracy : ',train_score)
#0.8943661971830986

y_test_pred=model.predict(x_test)
test_score=accuracy_score(y_test,y_test_pred)
print('test score accuracy: ',test_score)
#test score accuracy:  0.951048951048951

#================================================================

#DecisionTree

from sklearn.model_selection import KFold
kf= KFold(n_splits=5,shuffle=True,random_state=42)

#-----MODEL SELECTION
from sklearn.tree import DecisionTreeClassifier
model=DecisionTreeClassifier()
my_params= { 'n_neighbors':[3,5,7,8,9],
            'metric':['minkowski'  , 'euclidean' , 'manhattan'],
           'weights':['uniform','distance']}

from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test=train_test_split(x,y,test_size=0.25, shuffle=True, random_state=42)

from sklearn.tree import DecisionTreeClassifier
model=DecisionTreeClassifier(max_depth=1,random_state=42)

model.fit(x_train,y_train)

y_pred=model.predict(x_train)
train_score=accuracy_score(y_train,y_pred)
print(train_score)
#0.9225352112676056
y_pred=model.predict(x_test)
test_score=accuracy_score(y_test,y_pred)
print(test_score) 
#0.8951048951048951

#============================================================================
#RandomForest
from sklearn.model_selection import KFold
kf= KFold(n_splits=5,shuffle=True,random_state=42)

#-----MODEL SELECTION
from sklearn.ensemble import RandomForestClassifier
model=RandomForestClassifier()
my_params= { 'n_neighbors':[3,5,7,8,9],
            'metric':['minkowski'  , 'euclidean' , 'manhattan'],
           'weights':['uniform','distance']}

from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test=train_test_split(x,y,test_size=0.25, shuffle=True, random_state=42)

from sklearn.ensemble import RandomForestClassifier
model=RandomForestClassifier(random_state=42,n_estimators=40)

model.fit(x_train,y_train)

y_pred=model.predict(x_train)
train_score=accuracy_score(y_train,y_pred)
print(train_score)
#1.0
y_pred=model.predict(x_test)
test_score=accuracy_score(y_test,y_pred)
print(test_score) 
#0.958041958041958

#===========================================================================

#dar enteha behtarin model ba kamtarin darsad khata RandomForest hast

